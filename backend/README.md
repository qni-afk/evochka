# Evochka API

Backend API сервер для веб-приложения EvochkaWeb, обеспечивающий хранение и синхронизацию данных пользователя.

## Установка

1. Создайте директорию для бэкенда и перейдите в нее:
```bash
mkdir -p backend
cd backend
```

2. Создайте необходимые файлы (server.js, package.json) как показано в этом репозитории.

3. Установите зависимости:
```bash
npm install
```

4. Запустите сервер в режиме разработки:
```bash
npm run dev
```

Или в production режиме:
```bash
npm start
```

Сервер будет запущен на порту 5000 (или на порту, указанном в переменной окружения PORT).

## Особенности для Windows

При запуске на Windows, возможно, потребуется использовать Node.js без ESM (убрать "type": "module" из package.json) или настроить запуск с помощью nodemon:

```json
"scripts": {
  "start": "node server.js",
  "dev": "nodemon --experimental-modules server.js"
}
```

## API Endpoints

### Получение данных пользователя
```
GET /api/user/:userId
```

#### Параметры
- `userId`: Идентификатор пользователя (например, 'eva')

#### Ответ
```json
{
  "wishes": [...],
  "features": [...],
  "colorTheme": "pink"
}
```

### Сохранение данных пользователя
```
POST /api/user/:userId
```

#### Параметры
- `userId`: Идентификатор пользователя (например, 'eva')

#### Тело запроса
```json
{
  "wishes": [...],
  "features": [...],
  "colorTheme": "pink"
}
```

#### Ответ
```json
{
  "success": true,
  "message": "Данные успешно сохранены"
}
```

### Обновление отдельных данных пользователя
```
PATCH /api/user/:userId
```

#### Параметры
- `userId`: Идентификатор пользователя (например, 'eva')

#### Тело запроса
```json
{
  "wishes": [...]
}
```

#### Ответ
```json
{
  "success": true,
  "message": "Данные успешно обновлены"
}
```

### Проверка работоспособности API
```
GET /api/health
```

#### Ответ
```json
{
  "status": "UP",
  "message": "API работает корректно"
}
```

## Настройка CORS

API настроен для работы с фронтендом с любого источника. Для ограничения доступа, измените настройки CORS в server.js:

```javascript
app.use(cors({
  origin: 'http://localhost:5173', // Адрес фронтенд-приложения
  methods: ['GET', 'POST', 'PATCH'],
  credentials: true
}));
```

## Интеграция с фронтендом

Для интеграции API с фронтендом используйте файл `src/services/api.js`, который содержит необходимые функции для взаимодействия с API.

## Структура данных

API сохраняет данные пользователя в JSON-файлы в директории `backend/data/`. Каждый пользователь имеет свой собственный файл, именованный по его идентификатору (например, `eva.json`).
